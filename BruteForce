import hashlib
import random
import string
import time

def generate_random_password(length=6):
    chars = string.ascii_letters + string.digits
    return ''.join(random.choice(chars) for _ in range(length))

def hash_password(password):
    return hashlib.sha256(password.encode()).hexdigest()

def estimate_brute_force_time(password, attempts_per_second=1e9):
    chars = string.ascii_letters + string.digits
    charset_size = len(chars)
    total_attempts = sum(charset_size ** i for i in range(1, len(password) + 1))
    seconds = total_attempts / attempts_per_second
    return total_attempts, seconds

def simulate_realistic_brute_force():
    print("🔐 Simulating Brute Force Attack")

    password = generate_random_password(length=random.randint(5, 8))
    hashed_password = hash_password(password)

    print(f"[INFO] Generated random password (unknown to attacker)")
    print(f"[INFO] Hashed password: {hashed_password}")

    total_guesses, estimated_time = estimate_brute_force_time(password)

    print(f"\n📊 Estimated guesses to crack: {total_guesses:,}")
    print(f"⏳ Estimated time at 1 billion guesses/sec: {estimated_time:.2f} seconds")

simulate_realistic_brute_force()
